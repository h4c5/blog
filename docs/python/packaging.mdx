---
id: packaging-python
slug: packaging-python
title: Packager son code python
description: Packager son code python en 2023 avec setuptools et pyproject.toml
date: "2023-03-04"
tags:
    - python
    - packaging
    - setuptools
    - pyproject.toml
    - setup.py
    - setup.cfg
    - poetry
    - pipenv
---

import Giscus from "@site/src/components/Giscus.js";
import TOCInline from "@theme/TOCInline";

:::note Disclaimer

Les informations et conclusions de cet article sont bas√©es sur mes propres analyses et
interpr√©tations, elles ne sont pas enti√®rement fiables. Je vous invite √† vous
r√©f√©rer aux sources originelles et √† me faire vos retour en commentaire.

Encore mieux, n'h√©sitez √† proposer directement des
[modifications sur Github](https://github.com/h4c5/blog/edit/main/docs/python/packaging.mdx) üòâ

:::

## Sommaire

<TOCInline toc={toc.filter((node) => node.id !== "sommaire")} />

## C'est quoi le packaging en python ?

Packager son code, c'est l'emballer dans un joli paquet pour pouvoir le distribuer facilement √† d'autres personnes ou
le d√©ployer sur d'autres environnements que celui sur lequel on l'a d√©velopp√© üéÅ.

En fait vous utilisez tout le temps des paquets que d'autres ont emball√© pour vous. <br/>
C'est le cas √† chaque fois que vous faites : `import apackage`

Alors comment on fait pour rendre son code importable comme √ßa ? Et bien, c'est plus complexe qu'il n'y para√Æt. En fait
il y a tout un groupe de travail, la [Python Packaging Authority](https://github.com/pypa) (alias pypa), qui bosse
dessus [depuis 2011](https://www.pypa.io/en/latest/history/#before-2013).

## Un √©cosyst√®me assez compliqu√©

Voil√† comment le regrett√© [site Sam & Max](https://sametmax2.com/vive-setup-cfg-et-mort-a-pyproject-toml/index.html)
d√©crivait l'√©volution de l'√©cosyst√®me du packaging en python en 2018 :

> D'abord on a `distutils`, `setuptools`, `distribute`, and `distribute2` qui ont tous √©t√© √† un moment les "standards"
> recommand√©s pour packager une lib. Ensuite on a eu l'√©poque des `eggs`, `exe`, et autres trucs que `easy_install`
> allait chercher n'importe o√π dans la nature en suivant aveugl√©ment des liens sur PyPi. Sans compter les machins qu'il
> fallait compiler √† tout bout de champ. Et puis rien n'√©tait chiffr√© au download, `pip` n'√©tait pas packag√© avec
> Python, il crevait sur des erreurs stupides type encodage mal g√©r√©...
>
> √Ä √ßa se rajoute que `virtualenv` √©tait un truc √† part, avec plein de concurrents, et linkait les packages syst√®me par
> d√©faut. Sans oublier qu'on avait pas `python -m`.
>
> Bref, le packaging Python, √ßa a √©t√© vraiment la merde. Avec en plus une doc de merde.

Pas facile de se rep√©rer dans tout √ßa. J'ajouterai qu'en plus le packaging n'est pas toujours une notion abord√© lors des
formations python. C'est le genre de truc que l'on d√©couvre sur le tas le jour o√π on a besoin...

Je ne vais pas revenir ici sur tout l'historique d√©crit par Sam & Max car je ne l'ai pas connu et je pense que cela n'a
pas grand int√©r√™t. Je vais juste revenir sur les fa√ßons les plus courantes de proc√©der que j'ai trouv√© dans les
librairies que j'utilise couramment et sur la fa√ßon dont je proc√®de √† titre personnel.

### setup.py

Le fichier `setup.py` est le plus ancien des trois standards de packaging que je pr√©sente ici.

### setup.cfg

### pyproject.toml

## Le layout

### Le layout √† plat

### Le layout src

## Les Alernatives √† setuptools

La m√©thode de pac

### Pipenv

### Poetry

## TL;DR Packager son code python en 2023

## Aller plus loin

## R√©f√©rences

1. [Le Guide de pypa : An Overview of Packaging for Python](https://packaging.python.org/en/latest/overview/)

<Giscus />
